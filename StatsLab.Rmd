---
title: "StatsLab"
author: "Justin Glommen"
date: "2/5/2017"
output: html_document
---
## R Markdown

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Data Management
Loading data from current directory
```{r}
data <- read.table("videodata.txt", header=TRUE)
data.population <- 314     # True population
editData <- data     # Copy of data for the purpose of editting; a temp variable
head(data)
summary(data)
```


# Cleaning Data
Replacing 99 values (the unanswered/improper results) with NAs
```{r}
editData[editData == 99] <- NA
numSamples <- NROW(editData)
head(editData)
summary(editData)
```



## Scenario 1

# Sample Proportion of Students Who Played a Video Game in the Last Week
The individual variables measured here are Bernoulli since time is being converted to a binary 'did' or 'did not' play.
```{r}
# Create 'numPlayers' variable to count number of players in the last week.
# This is done by counting the number of people with time spent over 0, which represents the
# people who played something in the last week since they spent time on it. 0 indicates no time 
# spent.
numPlayers <- NROW(which(editData$time > 0))
paste("Number of players:", numPlayers, sep=" ")

# Sample proportion is the ratio of numPlayers to total students (rows in data)
editData.playersSampleProportion <- (numPlayers/numSamples)
paste("Sample proportion:", editData.playersSampleProportion, sep=" ")

```


# Players Sample Proportion Confidence Interval
Since the sample Bernoulli variables are NOT identically independentally distributed, the confidence interval itself will be computed utilizing the finite population correction factor.
```{r}
# Sample proportion is nearly Binomial, except not iid.
playersCorrectionFactor <- sqrt((data.population - numSamples)/data.population)
# Binomial standard error formula without correction
playersIndepStandardError <-  (sqrt(editData.playersSampleProportion*(1-editData.playersSampleProportion))/sqrt(numSamples - 1))
# Standard error with finite population correction
editData.playersStandardErrorEstimate <- playersIndepStandardError*playersCorrectionFactor
paste("Corrected Standard Error:", editData.playersStandardErrorEstimate, sep=" ")

# Since the sample proportion follows a normal distribution by the Central Limit Theorem,
# we need to multiply the corrected standard error by 1.96 to generate the interval.
editData.playersMarginOfError <- 1.96*editData.playersStandardErrorEstimate

# Therefore, the confidence interval:
playersLowerBound <- editData.playersSampleProportion - editData.playersMarginOfError
playersUpperBound <- editData.playersSampleProportion + editData.playersMarginOfError
editData.playersSampleProportionConf95 <- c(playersLowerBound, playersUpperBound)
paste("Player Proportion 95% CI: ", "(",playersLowerBound, ", ", playersUpperBound,")", sep="")
```





## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
